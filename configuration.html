<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Configuration &#8212; MapFish Print 2.3-SNAPSHOT documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/mapfish.css?v=1c0ae0b7" />
    <script src="_static/documentation_options.js?v=42aa45cd"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Protocol" href="protocol.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="protocol.html" title="Protocol"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MapFish Print 2.3-SNAPSHOT documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Configuration</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h1>
<p>The server side uses a <a class="reference external" href="http://www.yaml.org/">YAML</a> configuration file that defines the page layouts and allowed values. This file is usually called config.yaml.</p>
<section id="general-structure">
<h2>General structure<a class="headerlink" href="#general-structure" title="Link to this heading">¶</a></h2>
<p>Here is the general structure:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dpis</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">254</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">190</span>
<span class="w">  </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>

<span class="l l-Scalar l-Scalar-Plain">?maxSvgWidth</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2048</span><span class="w"> </span><span class="c1"># set the maximum dimensions to 2048 points, this is useful when using MapServer and a maximum dimension is there</span>
<span class="l l-Scalar l-Scalar-Plain">?maxSvgHeight</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2048</span>
<span class="l l-Scalar l-Scalar-Plain">?integerSvg</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span><span class="c1"># the library in MapServer &lt;= 5.6 does not support floating point values in the SVG coordinate space, set this to true if using a WMS that does not support floating point values in SVG coordinates</span>

<span class="l l-Scalar l-Scalar-Plain">?ignoreCapabilities</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span><span class="c1"># assume client is correct and do not load capabilities.  This is not recommended to be used unless you it fails when false (false is default)</span>
<span class="l l-Scalar l-Scalar-Plain">?disableLayersMerging</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span><span class="c1"># WMS layers with mergable parameters will be merged by default. Set this to true to disable attempts to merge.</span>
<span class="l l-Scalar l-Scalar-Plain">?maxPrintTimeBeforeWarningInSeconds</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span><span class="w"> </span><span class="c1"># if print jobs take longer than this then a warning in the logs will be written along with the spec.</span>
<span class="l l-Scalar l-Scalar-Plain">?printTimeoutMinutes</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w"> </span><span class="c1"># The maximum time to allow a print job to take before cancelling the print job.  The default is 5 (minutes)</span>
<span class="l l-Scalar l-Scalar-Plain">?formats</span><span class="p p-Indicator">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pdf</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">png</span>
<span class="w">  </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>

<span class="nt">scales</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25000</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50000</span>
<span class="w">  </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>

<span class="nt">hosts</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">HOST_WHITELIST_DEFINITION</span><span class="p p-Indicator">}</span>
<span class="w">  </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>

<span class="l l-Scalar l-Scalar-Plain">?localHostForward</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="c1"># For request on map.example.com we build an http request on localhost with the header Host=map.example.com, this is to don&#39;t pass throw the proxy.</span>
<span class="p p-Indicator">?</span><span class="w">  </span><span class="nt">from</span><span class="p">:</span>
<span class="p p-Indicator">?</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map.example.com</span>
<span class="p p-Indicator">?</span><span class="w">  </span><span class="nt">https2http</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"> </span><span class="c1"># For above hosts on request on https we build a request on http</span>

<span class="l l-Scalar l-Scalar-Plain">?headers</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;Cookie&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;Referer&#39;</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># The header that will be copyed to the tiles http requests</span>

<span class="l l-Scalar l-Scalar-Plain">?keys</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">?</span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!key</span>
<span class="p p-Indicator">?</span><span class="w">    </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="kt">!dnsMatch</span>
<span class="p p-Indicator">?</span><span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">maps.google.com</span>
<span class="p p-Indicator">?</span><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="p p-Indicator">?</span><span class="w">    </span><span class="nt">domain</span><span class="p">:</span><span class="w"> </span><span class="kt">!dnsMatch</span>
<span class="p p-Indicator">?</span><span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span>
<span class="p p-Indicator">?</span><span class="w">    </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1234456</span>
<span class="p p-Indicator">?</span><span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gmd-xyz</span>


<span class="l l-Scalar l-Scalar-Plain">?fonts</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">?</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">PATH</span><span class="p p-Indicator">}</span>

<span class="l l-Scalar l-Scalar-Plain">?globalParallelFetches</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="l l-Scalar l-Scalar-Plain">?perHostParallelFetches</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="l l-Scalar l-Scalar-Plain">?tilecacheMerging</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="l l-Scalar l-Scalar-Plain">?connectionTimeout</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30000           MF_V1.2</span>
<span class="l l-Scalar l-Scalar-Plain">?socketTimeout</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">180000              MF_V1.2</span>
<span class="l l-Scalar l-Scalar-Plain">?outputFilename</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mapfish-print      MF_V1.2</span>
<span class="l l-Scalar l-Scalar-Plain">?disableScaleLocking</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="l l-Scalar l-Scalar-Plain">?brokenUrlPlaceholder</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default      MF_V2.0</span>
<span class="l l-Scalar l-Scalar-Plain">?proxyBaseUrl</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://mapfishprint.org  MF_V2.0</span>
<span class="l l-Scalar l-Scalar-Plain">?tmsDefaultOriginX</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0f   MF_V2.0</span>
<span class="l l-Scalar l-Scalar-Plain">?tmsDefaultOriginY</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0f   MF_V2.0</span>

<span class="l l-Scalar l-Scalar-Plain">?security</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">?</span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!basicAuth</span>
<span class="p p-Indicator">?</span><span class="w">      </span><span class="nt">matcher</span><span class="p">:</span><span class="w"> </span><span class="kt">!dnsMatch</span>
<span class="p p-Indicator">?</span><span class="w">        </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.camptocamp.com</span>
<span class="p p-Indicator">?</span><span class="w">        </span><span class="nt">post</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="p p-Indicator">?</span><span class="w">      </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xyz</span>
<span class="p p-Indicator">?</span><span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zyx</span>
<span class="p p-Indicator">?</span><span class="w">      </span><span class="nt">preemptive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="p p-Indicator">?</span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!basicAuth</span>
<span class="p p-Indicator">?</span><span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">abc</span>
<span class="p p-Indicator">?</span><span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bca</span>

<span class="nt">layouts</span><span class="p">:</span>
<span class="w">   </span><span class="p p-Indicator">{</span><span class="nv">LAYOUT_NAME</span><span class="p p-Indicator">}:</span>
<span class="p p-Indicator">?</span><span class="w">   </span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mapfish-print.pdf  MF_V1.2</span>
<span class="p p-Indicator">?</span><span class="w">   </span><span class="nt">metaData</span><span class="p">:</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="p p-Indicator">{</span><span class="nv">METADATA_DEFINITION</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">?</span><span class="w">   </span><span class="nt">titlePage</span><span class="p">:</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="p p-Indicator">{</span><span class="nv">PAGE_DEFINITION</span><span class="p p-Indicator">}</span>
<span class="w">    </span><span class="nt">mainPage</span><span class="p">:</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">rotation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="p p-Indicator">{</span><span class="nv">PAGE_DEFINITION</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">?</span><span class="w">   </span><span class="nt">lastPage</span><span class="p">:</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="p p-Indicator">{</span><span class="nv">PAGE_DEFINITION</span><span class="p p-Indicator">}</span>
<span class="w">  </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Optional parts are shown with a question mark in the left margin. The question marks must not be put in the configuration file. Their default values is shown.</p>
<p>Note: Sets of values like DPI can be entered in one of two forms:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dpi</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="nv">...</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dpis</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">254</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">190</span>
</pre></div>
</div>
<section id="dpi-and-pdf-dimensions">
<h3>DPI and PDF Dimensions<a class="headerlink" href="#dpi-and-pdf-dimensions" title="Link to this heading">¶</a></h3>
<p>A chosen DPI value from the above configuration is used in WMS GetMap requests as an added format_options (GeoServer) or map_resolution (MapServer) parameter. This is used for symbol/label-rescaling suitable for high resolution printouts, see <a class="reference external" href="https://docs.geoserver.org/stable/en/user/services/wms/vendor.html">Geoserver format_options specification</a> (Geoserver 2.1) and <a class="reference external" href="http://mapserver.org/development/rfc/ms-rfc-55.html">MapServer defresolution keyword</a> (MapServer 5.6) for more information.</p>
<p>In general, PDF dimensions and positions are specified in points. 72 points == 1 inch == 25.4 mm.</p>
</section>
<section id="getting-maps">
<h3>Getting Maps<a class="headerlink" href="#getting-maps" title="Link to this heading">¶</a></h3>
<p>The list of {HOST_WHITELIST_DEFINITION} defines the allowed URLs for getting maps. Its format will be defined in <a class="reference external" href="configuration.html#host-whitelist-definition">the next sub-section</a>.</p>
<p>The formats element lists the values formats that the server permits.</p>
<ul class="simple">
<li><p>If omitted only ‘pdf’ is permitted.</p></li>
<li><p>If the single element ‘*’ (quotes are required) is present then all formats that the server can produce can be requested.</p></li>
</ul>
<p>The formats the server can produce depends to a large degree on how the Java is configured.</p>
<p>PDF is supported on all systems but for image output formats JAI and ImageIO is used which means both must be on the server for them to be available.  You can get the list of supported formats by running the standalone client with the <cite>–clientConfig</cite> flag enabled (you will need to supply a yaml config file as well).  If you are using the servlet then do a get info request to see the list of formats (with the ‘*’ as the outputFormats parameter in the config file).</p>
<p>“globalParallelFetches” and “perHostParallelFetches” are used to tune the parallel loading of the map tiles/images. If you want to disable the parallel loading, set “globalParallelFetches” to 1.</p>
<p>New versions of tilecache added the support for merging multiple layers in a single WMS request. If you want to use this functionality, set the “tilecacheMerging” attribute to true.</p>
<p>“connectionTimeout” and “socketTimeout” can be used to tune the timeouts for reading tiles from map servers.</p>
<p>“proxyBaseUrl” the optional url of the proxy between mapfish-print and the internet.  This is the url base that will be in the info.json response.  On occasion the url or port of the web server containing mapfish-print is not the server that is public to the internet and the requests are proxied to the mapfish-print webserver.  In this case it is important for the info.json request to return the public URL instead of the url of the webserver.</p>
<p>“tmsDefaultOriginX” By default this is null.  If non-null then TmsMapReader will use this as the origin x value if null then the origin will be derived from the maxExtent parameter.</p>
<p>“tmsDefaultOriginY” By default this is null.  If non-null then TmsMapReader will use this as the origin y value if null then the origin will be derived from the maxExtent parameter.</p>
</section>
<section id="layouts">
<h3>Layouts<a class="headerlink" href="#layouts" title="Link to this heading">¶</a></h3>
<p>You can have as many layouts as you want. Their name must be unique and will be used on the client side.</p>
<p>A layout can have a “titlePage” that will be added at the beginning of the generated document. It cannot contain any map.</p>
<p>The “mainPage” section is mandatory and will be used once for each page requested. The details of a {PAGE_DEFINITION} section can be found <a class="reference external" href="configuration.html#page-definition">in another sub-section of this document</a>.</p>
<p>A layout “lastPage”, will be added for the end of the document, and cannot contain any map.</p>
<p>If you want to let the user rotate the map (for a given layout), you have to set the “rotate” field to “true” in the corresponding “mainPage” section.</p>
</section>
<section id="output-filename">
<h3>Output filename<a class="headerlink" href="#output-filename" title="Link to this heading">¶</a></h3>
<p>If the ‘outputFilename’ parameter is defined in the main body then that name will be used by the MapPrintServlet when sending the pdf to the client.  It will be the name of the file that the client downloads. If the ‘outputFilename’ parameter is defined in a layout then that value will override the default name. In both cases the <cite>.pdf</cite> suffic is optional; if not present the server will append <cite>.pdf</cite> to the name.</p>
<p>In all cases the <cite>json</cite> request can override the filename defined in the configuration file by posting a ‘outputFilename’ attribute in the posted JSON. If the outputFilename has ${date}, ${time} or ${dateTime} in it, it will be replaced with the current date using the related DateFormat.get*Instance().format() method.  If a pattern is provided it will be passed to SimpleDataFormat for processing.  A few examples follow:</p>
<ul class="simple">
<li><p>outputFilename: “host-${yyyyMMdd}.pdf”   # results in host-20111213.pdf</p></li>
<li><p>outputFilename: “host-${date}”           # results in host-Dec_13_2011.pdf (actual output depends on local of server)</p></li>
<li><p>outputFilename: “host-${dateTime}”       # results in host-Dec_13_2011_1:10:50_PM.pdf (actual output depends on local of server)</p></li>
<li><p>outputFilename: “host-${time}.pdf”       # results in host-1:11:14_PM.pdf (actual output depends on local of server)</p></li>
<li><p>outputFilename: “host-${yyMMdd-hhmmss}”# results in host-111213-011154.pdf (actual output depends on local of server)</p></li>
</ul>
<p>“disableScaleLocking” allows you to bypass the choosing of scale from the available factors, and simply use the suggested value produced inside MapBlock.java.</p>
</section>
<section id="broken-images">
<h3>Broken images<a class="headerlink" href="#broken-images" title="Link to this heading">¶</a></h3>
<p>“brokenUrlPlaceholder” the placeholder image to use in the case of a broken url.  By default, when a url request fails, an error is thrown and the pdf process terminates.  However if this parameter is set then instead a placeholder image is returned.</p>
<p>Non-null values are:</p>
<ul class="simple">
<li><p>“default” - use the system default image.</p></li>
<li><p>“throw” - throw an exception.</p></li>
<li><p>&lt;url&gt; - obtain the image from the supplied url.  If this url is broken then an exception will be thrown.  This can be anytype of valid url from a file url to https url.</p></li>
</ul>
</section>
</section>
<section id="security">
<h2>Security<a class="headerlink" href="#security" title="Link to this heading">¶</a></h2>
<p>Both Keys and Security are options for accessing protected services.  Keys are currently for Google maps premium accounts and Security is for other types and is more general  Currently only BasicAuth is supported but other strategies can easily be added</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">security</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!basicAuth</span>
<span class="w">        </span><span class="nt">matcher</span><span class="p">:</span><span class="w"> </span><span class="kt">!dnsMatch</span>
<span class="w">          </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.camptocamp.com</span>
<span class="w">          </span><span class="nt">post</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xyz</span>
<span class="w">        </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zyx</span>
<span class="w">        </span><span class="nt">preemptive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!basicAuth</span>
<span class="w">      </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">abc</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cba</span>
</pre></div>
</div>
<p>The above example has 2 security configuration.  Each option is tested (in order) to see if it can be used for the given URI and if it applies it is used to configure requests for the URI.  In the above example the first configuration will be used if the URI matches the hostmatcher provided if not then the second configuration will be applied.  The last configuration has no host matcher so it is applied to all URIs.</p>
<p>A basicAuth security configuration consists of 4 options</p>
<ul class="simple">
<li><p>matcher - a host matcher for determining which requests need the security to be applied</p></li>
<li><p>username - username for basicauth</p></li>
<li><p>password - password for basicauth</p></li>
<li><p>preemptive - optional, but for cases where the credentials need to be sent without the challenge</p></li>
</ul>
<section id="x-forwarded-for">
<h3>X Forwarded For<a class="headerlink" href="#x-forwarded-for" title="Link to this heading">¶</a></h3>
<p>Added <code class="docutils literal notranslate"><span class="pre">addForwardedFor</span></code> optional flag (<code class="docutils literal notranslate"><span class="pre">true</span></code> / <code class="docutils literal notranslate"><span class="pre">false</span></code>) to enable by IP security.</p>
<p>When the option is <code class="docutils literal notranslate"><span class="pre">true</span></code>, every request to WMS services have an <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code> header with the client IP / name, so that IP based security rules are correctly applied by the underlying service.</p>
</section>
</section>
<section id="keys">
<h2>Keys<a class="headerlink" href="#keys" title="Link to this heading">¶</a></h2>
<p>Google maps currently requires a private key to be used (we only support users Google maps premium accounts).</p>
<p>The keys section allows a key to be mapped to hosts.  The hosts are identified with host matchers that are described in the &lt;configuration.html#host-whitelist-definition&gt; sub-section.</p>
<p>In addition a domain hostmatcher can be used to select a key based on the domain of the local server.  This can be useful if the same configuration is used in a test environment and a production environment with differing domains.  For example mapfish.org and mapfish.net.</p>
<p>Finally google maps (for example) requires a client id as well that is associated with the private key.  There for in the case of google premium services a legal key would be:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">keys</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!key</span>
<span class="w">    </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yxcvyxvcyxvyx</span>
<span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gme-xxxcs</span>
</pre></div>
</div>
<p>Thanks to the hosts and domain matcher it is possible to have a key for google maps and (for future proofing) a different key for a different service.</p>
</section>
<section id="fonts-definition">
<h2>Fonts definition<a class="headerlink" href="#fonts-definition" title="Link to this heading">¶</a></h2>
<p>The “fonts” section is optional. It contains the path of the fonts you want to use. The entries can point to files (TTF, OTF, TTC, AFM, PFM) or directories. Don’t point to directories containing too many files since it will slow down the start time. By default, PDF gives you access to the following fonts (Cp1252 encoding only):</p>
<ul class="simple">
<li><p>Courrier (-Bold, -Oblique, -BoldOblique)</p></li>
<li><p>Helvetica (-Bold, -Oblique, -BoldOblique)</p></li>
<li><p>Times (-Roman, -Bold, -Oblique, -BoldOblique)</p></li>
<li><p>Symbol</p></li>
<li><p>ZapfDingbats</p></li>
</ul>
</section>
<section id="host-whitelist-definition">
<h2>Host whitelist definition<a class="headerlink" href="#host-whitelist-definition" title="Link to this heading">¶</a></h2>
<p>In this section, you can put as many entries as you want, even for the same type of filter. If at least one matches, the Map server can be used.</p>
<p>This section is not for defining which client can request maps. It is just here to avoid having the print module used as a proxy to access documents from computers behind firewalls.</p>
<p>There are 3 ways to whitelist a host.</p>
<section id="allowing-every-local-services">
<h3>Allowing every local services:<a class="headerlink" href="#allowing-every-local-services" title="Link to this heading">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!localMatch</span>
<span class="w">  </span><span class="nt">dummy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>The “dummy” parameter is ignored, but mandatory to avoid a limitation in the YAML format.</p>
</section>
<section id="allowing-by-dns-name">
<h3>Allowing by DNS name:<a class="headerlink" href="#allowing-by-dns-name" title="Link to this heading">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!dnsMatch</span>
<span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">labs.metacarta.com</span>
</pre></div>
</div>
</section>
<section id="allowing-by-ip-address">
<h3>Allowing by IP address:<a class="headerlink" href="#allowing-by-ip-address" title="Link to this heading">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!ipMatch</span>
<span class="w">    </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.camptocamp.org</span>
<span class="p p-Indicator">?</span><span class="w">   </span><span class="nt">mask</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">255.255.255.255</span>
</pre></div>
</div>
<p>The “ip” parameter can be a DNS name that will be resolved or directly an IP address.</p>
<p>All the methods accept the following optional parameters:</p>
<ul class="simple">
<li><p>port: to limit to a certain TCP port</p></li>
<li><p>pathRegexp: a regexp that must match the path part of the URL (before the ‘?’).</p></li>
</ul>
</section>
</section>
<section id="metadata-definition">
<h2>Metadata definition<a class="headerlink" href="#metadata-definition" title="Link to this heading">¶</a></h2>
<p>Allow to add some metadata to the generated PDF. They are visible in acroread in the File-&gt;Properties menu.</p>
<p>The structure is like that:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="nt">metaData</span><span class="p">:</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">subject</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">keywords</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">creator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">supportLegacyReader</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<p>All fields are optional and can use global variables, as defined in the <a class="reference external" href="configuration.html#block-definition">Block definition</a> chapter. Page specific variables are not accessible.</p>
</section>
<section id="page-definition">
<h2>Page definition<a class="headerlink" href="#page-definition" title="Link to this heading">¶</a></h2>
<p>The structure is like that:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="nt">pageSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A4</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">landscape</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">marginLeft</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">marginRight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">marginTop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">marginBottom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">backgroundPdf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template.pdf</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">header</span><span class="p">:</span>
<span class="w">        </span><span class="nt">height</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">        </span><span class="nt">items</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">BLOCK_DEFINITION</span><span class="p p-Indicator">}</span>
<span class="w">          </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>
<span class="w">      </span><span class="nt">items</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">BLOCK_DEFINITION</span><span class="p p-Indicator">}</span>
<span class="w">        </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">footer</span><span class="p">:</span>
<span class="w">        </span><span class="nt">height</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">        </span><span class="nt">items</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">BLOCK_DEFINITION</span><span class="p p-Indicator">}</span>
<span class="w">          </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">includeTitlePage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">includeLastPage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">includeExtraPage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>With the “condition” we can completely hide a page, same behavior than in block.</p>
<p>If “backgroundPdf” is specified, the first page of the given PDF file will be added as background of every page.</p>
<p>The “header” and “footer” sections are optional. If the “items” that are in the main section are too big, more pages are generated. The header and footer will be drawn on those pages as well.</p>
<p>Here is a short list of supported <strong>pageSizes</strong>:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>name</p></th>
<th class="head" rowspan="2"><p>width</p></th>
<th class="head" rowspan="2"><p>height</p></th>
</tr>
<tr class="row-even"></tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="2"><p>LETTER</p></td>
<td rowspan="2"><p>612</p></td>
<td rowspan="2"><p>792</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>LEGAL</p></td>
<td rowspan="2"><p>612</p></td>
<td rowspan="2"><p>1008</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>A4</p></td>
<td rowspan="2"><p>595</p></td>
<td rowspan="2"><p>842</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>A3</p></td>
<td rowspan="2"><p>842</p></td>
<td rowspan="2"><p>1191</p></td>
</tr>
<tr class="row-even"></tr>
</tbody>
</table>
<p>The complete list can be found in <a class="reference external" href="http://api.itextpdf.com/itext/com/itextpdf/text/PageSize.html">http://api.itextpdf.com/itext/com/itextpdf/text/PageSize.html</a>. If you want to use a custom page size, you can set <strong>pageSize</strong> to the width and the height separated by a space.</p>
<section id="skip-rendering-of-pages">
<h3>Skip Rendering Of Pages<a class="headerlink" href="#skip-rendering-of-pages" title="Link to this heading">¶</a></h3>
<p>New flag params to skip rendering of particular pages have been implemented:</p>
<ul class="simple">
<li><p><cite>includeTitlePage</cite></p></li>
<li><p><cite>includeLastPage</cite></p></li>
<li><p><cite>includeExtraPage</cite></p></li>
</ul>
<p>They are all defaulted to true.</p>
</section>
<section id="extra-pages">
<h3>Extra Pages<a class="headerlink" href="#extra-pages" title="Link to this heading">¶</a></h3>
<p>Additional Pages are supported in many different places. They can be rendered due to legends overflowing on multiple pages, or by the dynamic images functionality.</p>
<p>Where additional pages can be generated, the generating block will be spread among all the created pages (for example, the legend block will put legends on different pages, if configured to do so). If you want to put additional blocks on additional page, you can specify the <cite>renderOnExtraPage</cite> flag on the desired blocks. Only first level blocks are considered.</p>
<p>In addition to that, an explicit <cite>extraPage</cite> block can be used in <code class="file docutils literal notranslate"><span class="pre">config.yaml</span></code> to add a custom page between other pages. The <cite>renderOn</cite> property specify the exact position for rendering (<cite>beforeMainPage</cite>, <cite>beforeLastPage</cite> or <cite>afterLastPage</cite>).</p>
</section>
</section>
<section id="id1">
<h2>Block definition<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>The next sub-sections document the possible types of blocks.</p>
<p>In general, text values or URLs can contain values taken from the <strong>spec</strong> structure coming with the client’s request. A syntax similar to shell is used: <cite>${variableName}</cite>. If the current page is a <strong>titlePage</strong>, only the root values are taken. If it’s a <strong>mainPage</strong>, the service will first look in the current <strong>page</strong> section then in the root values. Here is how to use this functionality:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">text</span><span class="p">:</span> <span class="s1">&#39;The value of mapTitle is: $</span><span class="si">{mapTitle}</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>Some virtual variables can be used:</p>
<ul class="simple">
<li><p>${pageNum}: The current page number.</p></li>
<li><p>${pageTot}: The total number of pages. Can be used only in text blocks.</p></li>
<li><p>${now}: The current date and time as defined by the machine’s locale.</p></li>
<li><p>${now FORMAT}: The current date and time as defined by the FORMAT string. The syntax is here: <a class="reference external" href="http://java.sun.com/j2se/1.5.0/docs/api/java/text/SimpleDateFormat.html">http://java.sun.com/j2se/1.5.0/docs/api/java/text/SimpleDateFormat.html</a>.</p></li>
<li><p>${configDir}: The absolute path to the directory of the configuration file.</p></li>
<li><p>${format PRINTF VAR}: Format the value of VAR using the provided <a class="reference external" href="http://java.sun.com/j2se/1.5.0/docs/api/java/util/Formatter.html#syntax">PRINTF format</a> (for example: %,d).</p></li>
</ul>
<p>All the blocks can have a condition attribute that takes a spec attribute name. If the attribute name exists and is not equal to “false” or “0”, the block is drawn. Otherwise, it is ignored. An exclamation mark may precede the condition to invert it, exclamation mark is part of yaml syntax, than the expression should be in quotes.</p>
<p>Example: show text block only if in the spec the attribute name “showText” is given, is not equal to “false” and not equal to “0”:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!text</span>
<span class="w">  </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mytext&#39;</span>
<span class="w">  </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">showText</span>
</pre></div>
</div>
</section>
<section id="text-block">
<h2>Text block<a class="headerlink" href="#text-block" title="Link to this heading">¶</a></h2>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!text</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">font</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Helvetica</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">fontSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">fontEncoding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Cp1252</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">fontColor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">spacingAfter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">align</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">left</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">vertAlign</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">middle</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">backgroundColor</span><span class="p">:</span><span class="w"> </span><span class="c1">#FFFFFF</span>
<span class="w">          </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Blahblah&#39;</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">asHTML</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<p>Typical “fontEncoding” values are:</p>
<ul class="simple">
<li><p>Cp1250</p></li>
<li><p>Cp1252</p></li>
<li><p>Cp1257</p></li>
<li><p>Identity-H (horizontal UTF-8)</p></li>
<li><p>Identity-V (vertical UTF-8)</p></li>
<li><p>MacRoman</p></li>
</ul>
<p>The “font” must refer to a standard PDF font or a <a class="reference external" href="configuration.html#fonts-definition">declared font</a>.</p>
<section id="html-in-text-blocks">
<h3>HTML In Text Blocks<a class="headerlink" href="#html-in-text-blocks" title="Link to this heading">¶</a></h3>
<p>The new configuration property <cite>asHTML</cite> (to be used in <code class="file docutils literal notranslate"><span class="pre">config.yaml</span></code> text blocks) allows to automatically render the included text as HTML (when true), instead of simple text. HTML tags are interpreted and styled.</p>
</section>
</section>
<section id="image-block">
<h2>Image block<a class="headerlink" href="#image-block" title="Link to this heading">¶</a></h2>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!image</span>
<span class="w">          </span><span class="nt">maxWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200</span>
<span class="w">          </span><span class="nt">maxHeight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">spacingAfter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">align</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">left</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">vertAlign</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">middle</span>
<span class="w">          </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://trac.mapfish.org/trac/mapfish/chrome/site/img/mapfish.png</span>
</pre></div>
</div>
<p>Supported formats are PNG, GIF, Jpeg, Jpeg2000, BMP, WMF (vector), SVG and TIFF.</p>
<p>The original aspect ratio will be respected. The url can contain “${}” variables.</p>
<section id="simple-colored-box-icons">
<h3>Simple colored box icons<a class="headerlink" href="#simple-colored-box-icons" title="Link to this heading">¶</a></h3>
<p>This enhancement adds the feature of drawing a simple colored box, instead of an icon into a legend item.</p>
<p>To draw a colored box, include a color: #hexvalue property in the printing spec, instead of an icon: url property.</p>
</section>
<section id="base64">
<h3>Base64<a class="headerlink" href="#base64" title="Link to this heading">¶</a></h3>
<p>We added support for Base64 encoded images uris to PDFUtils so that embedded images can be included for styling vector points (for example).</p>
<p>Example url:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data:image/png;base64,&lt;encoded image&gt;</span>
</pre></div>
</div>
</section>
<section id="images-content">
<h3>Images content<a class="headerlink" href="#images-content" title="Link to this heading">¶</a></h3>
<p>This enhancement allow you add SVG content inside the specification of the print.
You need to add a name into the image to manage:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!columns</span>
<span class="w">    </span><span class="nt">width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">580</span>
<span class="w">    </span><span class="nt">height</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">271</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">absoluteX:70</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">absoluteY:400</span>
<span class="w">    </span><span class="nt">items</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!image</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">chart1</span>
<span class="w">        </span><span class="nt">maxWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">580</span>
<span class="w">        </span><span class="nt">maxHeight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">271</span>
<span class="w">        </span><span class="nt">rotation</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${rotation}&#39;</span>
</pre></div>
</div>
<p>Spec:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="nv">...</span>
<span class="nv">chart1</span><span class="p p-Indicator">:{</span>
<span class="nt">  content</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&lt;svg&gt;SVG</span><span class="nv"> </span><span class="s">content&lt;/svg&gt;&#39;</span>
<span class="p p-Indicator">},</span>
<span class="nv">...</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>then, the content its rendered inside the print page with the layout configuration.</p>
</section>
</section>
<section id="columns-block">
<h2>Columns block<a class="headerlink" href="#columns-block" title="Link to this heading">¶</a></h2>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!columns</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">TABLE_CONFIG</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">widths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">25</span><span class="p p-Indicator">,</span><span class="nv">25</span><span class="p p-Indicator">,</span><span class="nv">25</span><span class="p p-Indicator">,</span><span class="nv">25</span><span class="p p-Indicator">]</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">backgroundColor</span><span class="p">:</span><span class="w"> </span><span class="c1">#FFFFFF</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">absoluteX</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">absoluteY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">width</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">PAGE_WIDTH</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">spacingAfter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">nbColumns</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-1</span>
<span class="w">          </span><span class="nt">items</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">BLOCK_DEFINITION</span><span class="p p-Indicator">}</span>
<span class="w">            </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Can be called <strong>!table</strong> as well.</p>
<p>By default, the width of the columns will be equal.</p>
<p>Each item will be in its own column.</p>
<p>If the <strong>absoluteX</strong>, <strong>absoluteY</strong> and <strong>width</strong> are given, the columns block will be floating on top of the page at the specified position.</p>
<p>The <strong>widths</strong> attribute can be used to change the width of the columns (by default, they have the same width). It must contain one integer for each column. The width of a given column is <cite>tableWidth*columnWeight/sum(columnWeight)</cite>.</p>
<p>Every block type is allowed except for <strong>map</strong> if the column has an absolute position.</p>
<p>Look at
&lt;<a class="reference external" href="http://trac.mapfish.org/trac/mapfish/wiki/PrintModuleServer#Tableconfiguration">http://trac.mapfish.org/trac/mapfish/wiki/PrintModuleServer#Tableconfiguration</a>
to know how to specify the <strong>config</strong> field.</p>
</section>
<section id="map-block">
<h2>Map block<a class="headerlink" href="#map-block" title="Link to this heading">¶</a></h2>
<p>Allowed only within a <strong>mainPage</strong>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!map</span>
<span class="w">          </span><span class="nt">width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">          </span><span class="nt">height</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">spacingAfter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">align</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">left</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">vertAlign</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">middle</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">absoluteX</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">absoluteY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">overviewMap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">backgroundColor</span><span class="p">:</span><span class="w"> </span><span class="c1">#FFFFFF</span>
</pre></div>
</div>
<p><strong>width</strong> and <strong>height</strong> are mandatory. You can use variable substitution in this part, but if you do so, the browser won’t receive the map size when it calls <strong>info.json</strong>. You’ll have to <strong>override mapfish.widgets.print.Base.configReceived</strong> and set the map width and height of your layouts.</p>
<p>If the <strong>absoluteX</strong> and <strong>absoluteY</strong> are given, the map block will be floating on top of the page at the specified position.</p>
<p>The <strong>name</strong> is what will be displayed in the Acrobat’s reader layer panel. The map layers will be displayed bellow it.</p>
<p>If <strong>overviewMap</strong> is specified, the map will be an overview of the extent augmented by the given factor. There are few cases to consider with map overviews:</p>
<ol class="arabic simple">
<li><p>If there is no overview overrides and no OL.Control.MapOverview, then all the layers will figure in the PDF map overview.</p></li>
<li><p>If there are overview overrides, the OL map overview control is ignored.</p></li>
<li><p>If there are no overview overrides and there is an OL.Control.MapOverview (takes the first one), then the layers defined in the control are taken into account. By default it is the current base layer.</p></li>
</ol>
</section>
<section id="scalebar-block">
<h2>Scalebar block<a class="headerlink" href="#scalebar-block" title="Link to this heading">¶</a></h2>
<p>Display a scalebar.</p>
<p>Allowed only within a <strong>mainPage</strong>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!scalebar</span>
<span class="w">          </span><span class="nt">maxSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">line</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">intervals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">subIntervals</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">units</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">barSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">lineWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">barDirection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">up</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">textDirection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">up</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">labelDistance</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">font</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Helvetica</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">fontSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">fontColor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="c1">#000000</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">barBgColor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">spacingAfter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">align</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">left</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">vertAlign</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">middle</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">backgroundColor</span><span class="p">:</span><span class="w"> </span><span class="c1">#FFFFFF</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">lockUnits</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">preferredIntervals</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="nv">10</span><span class="p p-Indicator">]</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">preferredIntervalFractions</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0</span>
</pre></div>
</div>
<p>The scalebar, will adapt its width up to <cite>maxSize</cite> (includes the labels) in order to have a multiple of 1, 2 or 5 values at each graduation. For example:</p>
<ul class="simple">
<li><p>0, 1, 2, …</p></li>
<li><p>0, 2, 4, …</p></li>
<li><p>0, 5, 10, …</p></li>
<li><p>0, 10, 20, …</p></li>
</ul>
<p>The <cite>barSize</cite> is the thickness of the bar or the height of the tick marks on the line. The <cite>lineWith</cite> is for the thickness of the lines (or bar border).</p>
<p>Units can be any of:</p>
<ul class="simple">
<li><p>m (mm, cm, m or km)</p></li>
<li><p>ft (in, ft, yd, mi)</p></li>
<li><p>degrees (min, sec, °)</p></li>
</ul>
<p>If the value is too big or too small, the module will switch to one of the unit in parenthesis (the same unit is used for every intervals).  If this behaviour is not desired, the lockUnits parameter will force the declared unit (or map unit if no unit is declared) to be used for the scalebar.</p>
<p>The number of <cite>intervals</cite> can be set to anything &gt;=2. Labels are drawn only at main intervals. If there is no space to display a label at a certain interval, this label won’t be displayed. If <cite>subIntervals</cite> are enabled, their number will depend on the length of an interval.</p>
<p>The type can be:</p>
<ul class="simple">
<li><p>line: A simple line with graduations</p></li>
<li><p>bar: A thick bar with a suite of color and barBgColor blocks.</p></li>
<li><p>bar_sub: Like bar, but with little lines for labels.</p></li>
</ul>
<img alt="_images/scalebarTypes.png" src="_images/scalebarTypes.png" />
<p>The bar and/or text orientation can be set to “up”, “down”, “left” or “right”.</p>
<p>The <cite>align</cite> attribute is for placing the whole scalebar withing the surrounding column or page. The <cite>vertAlign</cite> attribute is used only when placed in a column.</p>
<p>Labels are always centered on the graduation, at a distance specified by labelDistance.</p>
<section id="custom-intervals-in-scalebarblock">
<h3>Custom intervals in ScalebarBlock<a class="headerlink" href="#custom-intervals-in-scalebarblock" title="Link to this heading">¶</a></h3>
<p>With this improvement we added two new configuration parameters to <cite>!scalebar</cite> blocks that allow to customize the scalebar preferred bar lengths.</p>
<p>Now this set can be customized using the <cite>preferredIntervals</cite> property. This property is an array with the new (integer) allowed lengths. By default these were chosen in the <cite>1</cite>,`2`,`5`,`10` set.</p>
<p>Another property, <cite>preferredIntervalFractions</cite>, can be specified to also use fractional intervals. By default only <cite>0.0</cite> is used, and thus only integer lengths are allowed.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">yaml</span>
</pre></div>
</div>
<blockquote>
<div><p>preferredIntervals: [1,3,5,10]
preferredIntervalFractions: [0.2,0.5]</p>
</div></blockquote>
</section>
</section>
<section id="attributes-block">
<h2>Attributes block<a class="headerlink" href="#attributes-block" title="Link to this heading">¶</a></h2>
<p>Allows to display a table of the displayed feature’s attributes.</p>
<p>Allowed only within a <em>mainPage</em>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!attributes</span>
<span class="w">          </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">results</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">tableConfig</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">TABLE_CONFIG</span><span class="p p-Indicator">}</span>
<span class="w">          </span><span class="nt">columnDefs</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">{</span><span class="nv">COLUMN_NAME</span><span class="p p-Indicator">}:</span>
<span class="p p-Indicator">?</span><span class="w">             </span><span class="nt">columnWeight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0        MF_V1.2</span>
<span class="w">              </span><span class="nt">header</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">BLOCK_DEFINITION</span><span class="p p-Indicator">}</span>
<span class="w">              </span><span class="nt">cell</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">BLOCK_DEFINITION</span><span class="p p-Indicator">}</span>
<span class="w w-Error">            </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Look <a class="reference external" href="configuration.html#table-configuration">here</a> for how to specify the <em>tableConfig</em> field.</p>
<p>The <em>columnWeigth</em> (MF_V1.2 only) allows to define a weight for the column width. If you specify it for one column, you have to specify it for all of them. The width of a given column is tableWidth*columnWeight/sum(columnWeight).</p>
<p>The <strong>source</strong> value defines the name of the entry in the root of the client’s <strong>spec</strong>. For example, it would look like that:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="nv">...</span>
<span class="w">  </span><span class="nv">pages</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="p p-Indicator">{</span>
<span class="w">      </span><span class="nv">...</span>
<span class="w">      </span><span class="nv">results</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="nt">        data</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">          </span><span class="p p-Indicator">{</span><span class="nv">id</span><span class="p p-Indicator">:</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="nt"> name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;blah&#39;</span><span class="p p-Indicator">,</span><span class="nt"> icon</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;icon_pan&#39;</span><span class="p p-Indicator">},</span>
<span class="w">          </span><span class="nv">...</span>
<span class="w">        </span><span class="p p-Indicator">],</span>
<span class="nt">        columns</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;id&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;name&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;icon&#39;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="p p-Indicator">}</span>
<span class="w">    </span><span class="p p-Indicator">}</span>
<span class="w">  </span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nv">...</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>With this spec you would have to define 3 columnDefs with the names <strong>id</strong>, <strong>name</strong> and <strong>icon</strong>. Each cell definition blocks have access to all the values of the current row.</p>
<p>The spec part is filled automatically by the 2 MapFish widgets when their <a class="reference external" href="http://www.mapfish.org/apidoc/trunk/files/mapfish/widgets/print/Base-js.html#mapfish.widgets.print.Base.grids">grids</a> parameter is set.</p>
<p>Here is a crazy example of columnDef that will show the name of the icon and it’s bitmap side-by-side inside a single column:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">columnDefs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">icon</span><span class="p">:</span>
<span class="w">    </span><span class="nt">header</span><span class="p">:</span><span class="w"> </span><span class="kt">!text</span>
<span class="w">      </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Symbol</span>
<span class="w">      </span><span class="nt">backgroundColor</span><span class="p">:</span><span class="w"> </span><span class="c1">#A0A0A0</span>
<span class="w">    </span><span class="nt">cell</span><span class="p">:</span><span class="w"> </span><span class="kt">!columns</span>
<span class="w">      </span><span class="nt">items</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!text</span>
<span class="w">          </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${icon}&#39;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!image</span>
<span class="w">          </span><span class="nt">align</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">center</span>
<span class="w">          </span><span class="nt">maxWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span>
<span class="w">          </span><span class="nt">maxHeight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span>
<span class="w">          </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;http://www.mapfish.org/svn/mapfish/trunk/MapFish/client/mfbase/mapfish/img/${icon}.png&#39;</span>
</pre></div>
</div>
<p>A more complex example can be found in SVN: <a class="reference external" href="https://github.com/mapfish/mapfish-print-v2/tree/main/samples/config.yaml">config.yaml</a> <a class="reference external" href="https://github.com/mapfish/mapfish-print-v2/tree/main/samples/spec.json">spec.json</a></p>
<p>The print widgets are able to fill the spec for you based on a dictionary of <strong>Ext.grid.GridPanel</strong>. Just pass them through the grids parameter.</p>
<section id="group-rendering-in-attribute-blocks">
<h3>Group Rendering In Attribute Blocks<a class="headerlink" href="#group-rendering-in-attribute-blocks" title="Link to this heading">¶</a></h3>
<p>Attribute blocks now support grouping, by a specific attribute. Rows should be sorted by that attribute for grouping to work (no automatic sort is accomplished by the printing library).</p>
<p>To identify the grouping attribute, use the <cite>groupBy</cite> property.</p>
<p>Each group can be prefixed by a title, using the <cite>groupTitle</cite> property. You can specify any block in the <cite>groupTitle</cite> property, to render any kind of content as a title.</p>
<p>You can also skip table header using the <cite>includeHeader</cite> flag (true by default).</p>
<p>Finally you can force a page break before any new group, using the <cite>groupOnNewPage</cite> flag.</p>
</section>
</section>
<section id="legends-block">
<h2>Legends block<a class="headerlink" href="#legends-block" title="Link to this heading">¶</a></h2>
<p>Display each layers along with its classes (icons and labels).</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!legends</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">backgroundColor</span><span class="p">:</span><span class="w"> </span><span class="c1">#FFFFFF</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">borders</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">horizontalAlignment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">center</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">maxWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">maxHeight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">iconMaxWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">iconMaxHeight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">iconPadding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8 7 6 5</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">textMaxWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">textMaxHeight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">textPadding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8 7 6 5</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">defaultScale</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">inline</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">classIndentation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">layerSpaceBefore</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">layerSpace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">classSpace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">layerFont</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Helvetica</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">layerFontSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">classFont</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Helvetica</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">classFontSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">fontEncoding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Cp1252</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">columnMargin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">overflow</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">maxColumns</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">reorderColumns</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">dontBreakItems</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">fitWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">         </span><span class="nt">fitHeight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
</pre></div>
</div>
<p><strong>borders</strong> is mainly for debugging purpouses and shows all borders in the legend tables. This can be either ‘true’ or ‘false’.</p>
<p><strong>horizontalAlignment</strong> can be left, right or center (default) and aligns all items left, right or in the center.</p>
<p><strong>iconMaxWidth</strong>, <strong>iconMaxHeight</strong>, <strong>defaultScale</strong> with value of 0 indicate that the value will be ignored, i.e. the values are automatically set to the equivalent of Infinity, Infinity and 1 respectively. If the legends URL passed to MapFish (see <a class="reference external" href="http://mapfish.org/doc/print/protocol.html#print-pdf">http://mapfish.org/doc/print/protocol.html#print-pdf</a>) are obtained from a WMS GetLegendGraphic request, the width/height are only indicative (even more when a label text is included with <a class="reference external" href="https://docs.geoserver.org/stable/en/user/services/wms/get_legend_graphic/index.html#controlling-legend-appearance-with-legend-options">LEGEND_OPTIONS/forceLabels parameter</a>) and it would be safer, in order to preserve scale coherence between legends and map, to set <strong>iconMaxWidth</strong> and <strong>iconMaxHeight</strong> to zero.</p>
<p><strong>textMaxWidth/Height</strong> and <strong>iconMaxWidth/Height</strong> define how wide/high the text/icon cells of a legend item can be. At this point textMaxHeight is ignored.</p>
<p><strong>textPadding</strong> and <strong>iconPadding</strong> can be used like standard CSS padding. In the above example 8 is the padding top, 7 padding right, 6 padding bottom and 5 padding left.</p>
<p>if <strong>inline</strong> is true icons and text are rendered on the same line, BUT multicolumn is still enabled.</p>
<p>if <strong>maxWidth</strong> is set the whole legend gets a maximum width, just like other blocks. Note that <strong>maxWidth</strong> does not have any impact on icons size, thus icons may overflow outside the legends block.</p>
<p>if <strong>maxHeight</strong> is set the whole legend gets a maximum height. This forces more than one column to appear if the legend is higher than the specified value. This can be used to enable the multi-column layout. 0 makes the maxHeight= max value, i.e. the equivalent of infinity.</p>
<p>if <strong>defaultScale</strong> is non null it means that the legend image will be scaled so it doesn’t take the full space. This can be overriden for individual classes in the spec JSON sent to the print module by adding an attribute called ‘scale’ and giving it a number. In conjunction with iconMaxWidth/Height this can be used to control average and also maximum width/height. If <strong>defaultScale</strong> equals 1, one pixel is scaled to one point (1/72 inch) in generated PDF. By default, as GeoServer legends are generated with ~90 dpi resolution (exactly 25.4/0.28), setting <strong>defaultScale</strong> value to 0.7937 (72*0.28/25.4) produces legend icons of same size as corresponding map icons. As the <a class="reference external" href="https://docs.geoserver.org/stable/en/user/services/wms/get_legend_graphic/index.html#controlling-legend-appearance-with-legend-options">LEGEND_OPTIONS/dpi GeoServer parameter</a> is not handled by MapFish, the resolution will necessary be ~91 dpi, which may cause visual quality difference with the map.</p>
<p>For this to work, you need to set the <strong>layerTree</strong> config option on MF print widgets,
more precisely the legends should be present in the print.pdf JSON request.</p>
<p><strong>layerSpaceBefore</strong> is to specify the space before the second and consecutive layers.</p>
<p><strong>layerSpace</strong> and <strong>classSpace</strong> is to specify the line space to add after layers and classes.</p>
<p><strong>columnMaxWidth</strong> maximum width of a column in multi-column layout.</p>
<p><strong>maxColumns</strong> allows to specify a maximum number of columns to be used. After this number is reached, a new row is created.</p>
<p><strong>classIndentation</strong> amount of points to indent classes by.</p>
<p><strong>layerSpaceBefore</strong> if a layer is after another one, this defines the amount of space to have before it. This will not be applied if the layer is the first item in its column in multi-column layout.</p>
<p><strong>layerFont</strong> font of layer name legend items.</p>
<p><strong>layerFontSize</strong> font size of layer name.</p>
<p><strong>classFont</strong> font of class legend items.</p>
<p><strong>classFontSize</strong> font size of class.</p>
<p><strong>fontEncoding</strong> (see below)</p>
<section id="legend-fitting">
<h3>Legend fitting<a class="headerlink" href="#legend-fitting" title="Link to this heading">¶</a></h3>
<p>Support for legend fitting (legend resized to fit a given rectangle) has been added, through 2 new config.yaml configuration properties (to be used in legend blocks).</p>
<p>The properties are:</p>
<ul class="simple">
<li><p><cite>fitWidth</cite>: width of the rectangle for fitting (defaults to 0, meaning no fit)</p></li>
<li><p><cite>fitHeight</cite>: height of the rectangle for fitting (defaults to 0, meaning no fit)</p></li>
</ul>
<p>Both properties or only one of them can be specified. When only one property is set, the other dimension is calculated to mantain the original aspect ratio for the legend.</p>
</section>
<section id="multipage-legends">
<h3>Multipage legends<a class="headerlink" href="#multipage-legends" title="Link to this heading">¶</a></h3>
<p>By default a LegendsBlock must be contained in a single page. To allow it to span on several pages the <cite>overflow</cite> option can be used, setting it to true.</p>
<p>When this option is used you also need to define <cite>maxColumns</cite>, to fix the max number of columns on each page and <cite>maxHeight</cite>, to fix the maximum height of each column.</p>
<p>The LegendsBlock will be rendered on as many pages as needed to get all the items rendered with the given constraints.</p>
<p>Please note that if more than one page is needed, the second and following pages will only contain legend columns, without any of the other element of the page where the legends block is defined.</p>
</section>
<section id="creating-an-horizontal-layout-for-legends">
<h3>Creating an horizontal layout for legends<a class="headerlink" href="#creating-an-horizontal-layout-for-legends" title="Link to this heading">¶</a></h3>
<p>Using some <code class="docutils literal notranslate"><span class="pre">config.yaml</span></code> configuration options in an unusual way it is possible to have a layout for legends that is horizontal, instead of vertical.</p>
<p>To get this behaviour is necessary to:</p>
<ul class="simple">
<li><p>use the legend block <code class="docutils literal notranslate"><span class="pre">maxHeight</span></code> property with a very low value (e.g. 1) to force a new column for each legend item</p></li>
<li><p>use the legend block <code class="docutils literal notranslate"><span class="pre">maxColumns</span></code> value to choose the number of columns for the legend (a new row will be forced after <code class="docutils literal notranslate"><span class="pre">maxColumns</span></code> is reached)</p></li>
</ul>
</section>
<section id="reorder-legends-block-in-columns">
<h3>Reorder legends block in columns<a class="headerlink" href="#reorder-legends-block-in-columns" title="Link to this heading">¶</a></h3>
<p>When the option <cite>reorderColumns</cite> inside legends block it set to <cite>true</cite> and more than one column is necessary for the legends block, a new algorithm computes the best distribution of the legend items inside the columns. Currently a first fit with items sorted in height descending order is used. This is not sub-optimal, but it’s fast.</p>
<p>When a legend item is rendered to another column, by default name and legend icon could finish on different columns. To fix it, please enable the <cite>dontBreakItems</cite> option.</p>
</section>
<section id="don-t-break-legend-items">
<h3>Don’t break legend items<a class="headerlink" href="#don-t-break-legend-items" title="Link to this heading">¶</a></h3>
<p>Set the flag <cite>dontBreakItems</cite> to <cite>true</cite> on legends block if you want to render legend and names as one table to forbid the break between different columns</p>
</section>
</section>
<section id="table-configuration">
<h2>Table configuration<a class="headerlink" href="#table-configuration" title="Link to this heading">¶</a></h2>
<p>The <a class="reference external" href="#columns-block">columns block</a> and the <a class="reference external" href="#attributes-block">attributes block</a> can take a table configuration object like that:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderWidthLeft</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderWidthRight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderWidthTop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderWidthBottom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderColor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderColorLeft</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderColorRight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderColorTop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderColorBottom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">cells</span><span class="p">:</span>
<span class="p p-Indicator">?</span><span class="w">       </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">CELL_CONFIGURATION</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>A cell configuration looks like that:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">row</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">col</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderWidthLeft</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderWidthRight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderWidthTop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderWidthBottom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderColor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderColorLeft</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderColorRight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderColorTop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">borderColorBottom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">paddingLeft</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">paddingRight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">paddingTop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">paddingBottom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">backgroundColor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">white</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">align</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LEFT</span>
<span class="p p-Indicator">?</span><span class="w">     </span><span class="nt">vertAlign</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TOP</span>
</pre></div>
</div>
<p>The stuff configured at table level is for the table border, not every cell.</p>
<p>The <strong>cells</strong> list defines overrides for some cells. The cells an override is applied to is defined by the <strong>row</strong> and <strong>col</strong> attribute. Those attributes can have several formats:</p>
<ul class="simple">
<li><p><strong>0</strong>: apply only to row or column 0 (the first)</p></li>
<li><p><strong>0-10</strong>: applies only the row or columns from 0 to 10</p></li>
<li><p>or you can use any regular expression</p></li>
</ul>
<p>Every matching overrides is applied in order and will override the values defined in the previous ones.</p>
<p>For example, if you want to draw an attribute block like that:</p>
<img alt="_images/tableConfig.png" src="_images/tableConfig.png" />
<p>You define that:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!attributes</span>
<span class="w">  </span><span class="nt">tableConfig</span><span class="p">:</span>
<span class="w">    </span><span class="nt">borderWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">cells</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># match every cell (default cell formatting)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">borderWidthBottom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span>
<span class="w">        </span><span class="nt">borderWidthLeft</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span>
<span class="w">        </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">        </span><span class="nt">paddingTop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="c1"># match every even cell (yellowish background)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">row</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;\d*[02468]&#39;</span>
<span class="w">        </span><span class="nt">backgroundColor</span><span class="p">:</span><span class="w"> </span><span class="c1">#FFFFCC</span>
<span class="w">      </span><span class="c1"># for the header</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">row</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">        </span><span class="nt">borderWidthBottom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">backgroundColor</span><span class="p">:</span><span class="w"> </span><span class="c1">#FA0002</span>
<span class="w">        </span><span class="nt">align</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">center</span>
<span class="w">  </span><span class="p p-Indicator">{</span><span class="nv">...</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
</section>
<section id="dynamic-images-page">
<h2>Dynamic images page<a class="headerlink" href="#dynamic-images-page" title="Link to this heading">¶</a></h2>
<p>New layout to let you print a different number of pages dinamically.</p>
<p>You need to put it in <code class="file docutils literal notranslate"><span class="pre">config.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dynamicImagesPage</span><span class="p">:</span>
<span class="w">      </span><span class="nt">rotation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">pageSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">595 842</span>
<span class="w">      </span><span class="nt">landscape</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">items:[...]</span>
</pre></div>
</div>
<p>and when you called to the print servlet, you’ll need to add this property to the spec:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">imagesPages:[</span>
<span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">{firstPageConfiguration},</span>
<span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">{secondPageConfiguration}</span>
<span class="l l-Scalar l-Scalar-Plain">]</span>
</pre></div>
</div>
<p>then it’s render one page for each item found in the imagesPages property.</p>
<p>Also, you cant select the pages placement inside the document with the property <cite>renderOn</cite>:</p>
<ul class="simple">
<li><p><cite>afterLastPage</cite>: It’s rendered after the last page. It’s the default option active.</p></li>
<li><p><cite>beforeLastPage</cite>: It’s rendered just before last page (between main page and last page layouts)</p></li>
<li><p><cite>beforeMainPage</cite>: It’s rendered before main page (between first page and main page)</p></li>
</ul>
<p>The first use of this layout it’s add a dynamic number of pages with differents images with svg content generated dynamicaly (using also the images content enhancement). This is an example of use with two dynammic images by page:</p>
<p>Example <code class="file docutils literal notranslate"><span class="pre">config.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">...</span>
<span class="w"> </span><span class="nt">dynamicImagesPage</span><span class="p">:</span>
<span class="w">   </span><span class="nt">rotation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">   </span><span class="nt">pageSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">595 842</span>
<span class="w">   </span><span class="nt">landscape</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">   </span><span class="nt">items</span><span class="p">:</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!columns</span>
<span class="w">       </span><span class="nt">absoluteX</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">       </span><span class="nt">absoluteY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">812</span>
<span class="w">       </span><span class="nt">width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">535</span>
<span class="w">       </span><span class="nt">height</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">       </span><span class="nt">items</span><span class="p">:</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!image</span>
<span class="w">           </span><span class="nt">maxWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">535</span>
<span class="w">           </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${configDir}/print_header.png&#39;</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!columns</span>
<span class="w">       </span><span class="nt">absoluteX</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">       </span><span class="nt">absoluteY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">750</span>
<span class="w">       </span><span class="nt">width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">595</span>
<span class="w">       </span><span class="nt">widths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">595</span><span class="p p-Indicator">]</span>
<span class="w">       </span><span class="nt">items</span><span class="p">:</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!text</span>
<span class="w">           </span><span class="nt">align</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">center</span>
<span class="w">           </span><span class="nt">vertAlign</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">middle</span>
<span class="w">           </span><span class="nt">fontSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">14</span>
<span class="w">           </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${meteorologicalPagesTitle}&#39;</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!columns</span>
<span class="w">       </span><span class="nt">width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">580</span>
<span class="w">       </span><span class="nt">height</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">271</span>
<span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">absoluteX:70</span>
<span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">absoluteY:697</span>
<span class="w">       </span><span class="nt">items</span><span class="p">:</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!image</span>
<span class="w">           </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">chart1</span>
<span class="w">           </span><span class="nt">maxWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">580</span>
<span class="w">           </span><span class="nt">maxHeight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">271</span>
<span class="w">           </span><span class="nt">rotation</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${rotation}&#39;</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!columns</span>
<span class="w">       </span><span class="nt">width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">580</span>
<span class="w">       </span><span class="nt">height</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">271</span>
<span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">absoluteX:70</span>
<span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">absoluteY:400</span>
<span class="w">       </span><span class="nt">items</span><span class="p">:</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!image</span>
<span class="w">           </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">chart2</span>
<span class="w">           </span><span class="nt">maxWidth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">580</span>
<span class="w">           </span><span class="nt">maxHeight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">271</span>
<span class="w">           </span><span class="nt">rotation</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${rotation}&#39;</span>
</pre></div>
</div>
<p>spec:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="nv">...</span>
<span class="nv">imagePages</span><span class="p p-Indicator">:[</span>
<span class="w">    </span><span class="nv">images</span><span class="p p-Indicator">:{</span>
<span class="w">        </span><span class="nv">chart1</span><span class="p p-Indicator">:{</span>
<span class="nt">             content</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&lt;svg&gt;SVG</span><span class="nv"> </span><span class="s">content&lt;/svg&gt;&#39;</span>
<span class="w">        </span><span class="p p-Indicator">},</span>
<span class="w">        </span><span class="nv">chart2</span><span class="p p-Indicator">:{</span>
<span class="nt">             content</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&lt;svg&gt;SVG</span><span class="nv"> </span><span class="s">content&lt;/svg&gt;&#39;</span>
<span class="w">        </span><span class="p p-Indicator">}</span>
<span class="w">    </span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">],</span>
<span class="nv">...</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Configuration</a><ul>
<li><a class="reference internal" href="#general-structure">General structure</a><ul>
<li><a class="reference internal" href="#dpi-and-pdf-dimensions">DPI and PDF Dimensions</a></li>
<li><a class="reference internal" href="#getting-maps">Getting Maps</a></li>
<li><a class="reference internal" href="#layouts">Layouts</a></li>
<li><a class="reference internal" href="#output-filename">Output filename</a></li>
<li><a class="reference internal" href="#broken-images">Broken images</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security">Security</a><ul>
<li><a class="reference internal" href="#x-forwarded-for">X Forwarded For</a></li>
</ul>
</li>
<li><a class="reference internal" href="#keys">Keys</a></li>
<li><a class="reference internal" href="#fonts-definition">Fonts definition</a></li>
<li><a class="reference internal" href="#host-whitelist-definition">Host whitelist definition</a><ul>
<li><a class="reference internal" href="#allowing-every-local-services">Allowing every local services:</a></li>
<li><a class="reference internal" href="#allowing-by-dns-name">Allowing by DNS name:</a></li>
<li><a class="reference internal" href="#allowing-by-ip-address">Allowing by IP address:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#metadata-definition">Metadata definition</a></li>
<li><a class="reference internal" href="#page-definition">Page definition</a><ul>
<li><a class="reference internal" href="#skip-rendering-of-pages">Skip Rendering Of Pages</a></li>
<li><a class="reference internal" href="#extra-pages">Extra Pages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id1">Block definition</a></li>
<li><a class="reference internal" href="#text-block">Text block</a><ul>
<li><a class="reference internal" href="#html-in-text-blocks">HTML In Text Blocks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#image-block">Image block</a><ul>
<li><a class="reference internal" href="#simple-colored-box-icons">Simple colored box icons</a></li>
<li><a class="reference internal" href="#base64">Base64</a></li>
<li><a class="reference internal" href="#images-content">Images content</a></li>
</ul>
</li>
<li><a class="reference internal" href="#columns-block">Columns block</a></li>
<li><a class="reference internal" href="#map-block">Map block</a></li>
<li><a class="reference internal" href="#scalebar-block">Scalebar block</a><ul>
<li><a class="reference internal" href="#custom-intervals-in-scalebarblock">Custom intervals in ScalebarBlock</a></li>
</ul>
</li>
<li><a class="reference internal" href="#attributes-block">Attributes block</a><ul>
<li><a class="reference internal" href="#group-rendering-in-attribute-blocks">Group Rendering In Attribute Blocks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#legends-block">Legends block</a><ul>
<li><a class="reference internal" href="#legend-fitting">Legend fitting</a></li>
<li><a class="reference internal" href="#multipage-legends">Multipage legends</a></li>
<li><a class="reference internal" href="#creating-an-horizontal-layout-for-legends">Creating an horizontal layout for legends</a></li>
<li><a class="reference internal" href="#reorder-legends-block-in-columns">Reorder legends block in columns</a></li>
<li><a class="reference internal" href="#don-t-break-legend-items">Don’t break legend items</a></li>
</ul>
</li>
<li><a class="reference internal" href="#table-configuration">Table configuration</a></li>
<li><a class="reference internal" href="#dynamic-images-page">Dynamic images page</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="installation.html"
                          title="previous chapter">Installation</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="protocol.html"
                          title="next chapter">Protocol</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/configuration.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="protocol.html" title="Protocol"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MapFish Print 2.3-SNAPSHOT documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Configuration</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Camptocamp and others.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>